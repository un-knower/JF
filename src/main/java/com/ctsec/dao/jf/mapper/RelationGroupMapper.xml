<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ctsec.dao.jf.RelationGroupMapper" >
  <resultMap id="BaseResultMap" type="com.ctsec.model.jf.RelationGroup" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Dec 15 13:24:50 CST 2017.
    -->
    <constructor >
      <idArg column="id" jdbcType="BIGINT" javaType="java.lang.Long" />
      <arg column="name" jdbcType="VARCHAR" javaType="java.lang.String" />
      <arg column="is_delete" jdbcType="VARCHAR" javaType="java.lang.String" />
      <arg column="create_time" jdbcType="TIMESTAMP" javaType="java.util.Date" />
      <arg column="update_time" jdbcType="TIMESTAMP" javaType="java.util.Date" />
    </constructor>
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Dec 15 13:24:50 CST 2017.
    -->
    id, name, is_delete, create_time, update_time
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Dec 15 13:24:50 CST 2017.
    -->
    select 
    <include refid="Base_Column_List" />
    from relation_group
    where id = #{id,jdbcType=BIGINT}
  </select>
  
  <select id="selectOneCount" resultType="java.lang.Integer" parameterType="java.lang.String" >
    SELECT  count(`name`) as group_name
    from relation_group
    where is_delete = '0' and `name` = #{groupName}
  </select>

  <select id="selectMatch" resultType="java.lang.String" parameterType="java.lang.String" >
    select `name` as group_name
    from relation_group
    where is_delete = '0' and `name` like ${groupName}
  </select>

  <select id="selectOne" resultType="com.ctsec.model.jf.RelationGroup" parameterType="java.lang.String" >
    SELECT id
    from relation_group
    where is_delete = '0' and `name` = #{groupName}
  </select>

  <sql id="Group_Column_list">
    id, `name`
  </sql>
  <select id="selectAll" resultType="com.ctsec.model.jf.RelationGroup">
    select
    <include refid="Group_Column_list" />
    from relation_group
    where is_delete = '0'
  </select>

  <sql id="Group2_Column_list">
    id, `name`, create_time, update_time
  </sql>
  <select id="selectAll2" resultType="com.ctsec.model.jf.RelationGroup">
    select
    <include refid="Group2_Column_list" />
    from relation_group
    where is_delete = '0'
  </select>

  <sql id="Group3_Column_list">
    a.`name` as group_name, a.id as group_id, concat(b.`name`,'|',b.`code`) as item_name, b.`code` as item_code
  </sql>
  <select id="selectGroupAndItem" resultType="com.ctsec.vo.Relation">
    select
    <include refid="Group3_Column_list" />
    from relation_group a
    left join relation_item b on a.id=b.group_id
    where a.is_delete = '0' and b.is_delete = '0'
  </select>

  <insert id="insertOne" parameterType="com.ctsec.model.jf.RelationGroup">
    insert into relation_group (`name`,is_delete,create_time,update_time)
    values(#{group.name},'0',SYSDATE(),SYSDATE())
  </insert>

  <update id="deleteOne" parameterType="java.lang.Long">
    update relation_group set is_delete = '1'
    where id = #{id}
  </update>

  <update id="deleteOneByName" parameterType="java.lang.String">
    update relation_group set is_delete = '1'
    where `name` = #{groupName}
  </update>
  
</mapper>